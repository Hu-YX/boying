
# 使用技术说明
## Mybatis generator
MyBatis的代码生成器，可以根据数据库生成model、mapper.xml、mapper接口和Example，通常情况下的单表查询不用再手写mapper。

### CommentGenerator

写一个新类CommentGenerator实现`DefaultCommentGenerator`接口的方法来使自动生成的model类含有中文注释

### Generator

运行Generator的main函数生成代码

### bug解决


1. `The specified target project directory boying does not exist`.解决方案:将`boying/src/main/java`改为`src/main/java`
2. `closing inbound before receiving peer's close_notify`.解决方案:在配置文件`generator.properties`的`connectionURL`最后加上`&useSSL=false`
3. `Result Maps collection already contains value for com.tongji.mbg.mapper.UserMapper.BaseResultMap`删除原来生成的文件,重新逆向工程构建mapper等
4. 数据库中密码等字段要`varchar(255)`,不然加密后超出限制





## GitHub下载慢

用码云导入GitHub仓库



## MySQL

在cmd中执行

```
mysql -uroot -proot;
CREATE DATABASE mall;
USE mall;
source C:\\code_home\\mall\\document\\sql\\mall.sql;
```

## pom

build时需要先配置了`application.yml`

## Mybatis generator

在使用Mybatis的时候，dao接口，entity实体类，还有每个实体类对应的xml都得自己写吧，这其实也是工作量稍微大一点的事情，而我们的插件Mybatis-generator就是自动生成这些代码的

MyBatis Generator 生成的文件包含三类：

（1）Model实体文件，一个数据库表对应生成一个 Model 实体；
（2）Mapper接口文件，数据数操作方法都在此接口中定义；
（3）Mapper XML配置文件

## 标红

project structure设置jdk版本



# 实用软件

## Navicat

## PostMan

## Hutool

一个Java工具包，它帮助我们简化每一行代码

## Redis集群

## Spring Data Redis 

## Nginx

### 安装

```xml
<dependency>
    <groupId>cn.hutool</groupId>
    <artifactId>hutool-all</artifactId>
    <version>4.6.3</version>
</dependency>
```

### Convert
类型转换工具类

### BeanUtil

JavaBean的工具类，可用于Map与JavaBean对象的互相转换以及对象属性的拷贝

### CaptchaUtil
验证码工具类，可用于生成图形验证码。

### SecureUtil

加密解密工具类，可用于MD5加密。

## Nginx

# idea插件

## 操作

View->Tool Windows->Statistic 可以把东西放右边



## idea内置数据库

1. 上方使用`id=2`类似查询可以直接过滤
2. Alt+Enter各种代码提示
3. 右键可以查看执行计划,`Explain Plain`

## Free MyBatis Plugin

MyBatis扩展插件，可以在Mapper接口的方法和xml实现之间自由跳转，也可以用来一键生成某些xml实现。

## MyBatis Log Plugin

把Mybatis输出的SQL日志还原成完整的SQL语句

## RestfulToolkit

一套Restful服务开发辅助工具集，提供了项目中的接口概览信息，可以根据URL跳转到对应的接口方法中去，内置了HTTP请求工具，对请求方法做了一些增强功能



## Alibaba Java Coding Guidelines

阿里巴巴《Java 开发手册》配套插件，可以实时检测代码中不符合手册规约的地方，助你码出高效，码出质量。

## Statistic

一款代码统计工具，可以用来统计当前项目中代码的行数和大小。

## Vue.js

根据模板创建`.vue`文件，也可以对Vue相关代码进行智能提示。

## Element

Element-UI支持插件，可以对Element-UI中的标签进行智能提示



# 项目部署

## jar文件

```
netstat -tunlp |grep 8000
kill -s 9 30973

mvn install

cd /usr/local
nohup java -jar boying-user.jar 

```

## Dockerfile

```dockerfile
# 该镜像需要依赖的基础镜像
FROM java:8
# 将当前目录下的jar包复制到docker容器的/目录下
ADD boying.jar /boying.jar
# 运行过程中创建一个boying.jar文件
RUN bash -c 'touch /boying.jar'
# 声明服务运行在8000端口
EXPOSE 8000
# 指定docker容器启动时运行jar包
ENTRYPOINT ["java", "-jar","/boying.jar"]
# 指定维护者的名字
MAINTAINER tongji4m3
```

## Jenkins

### 运行Jenkins

```
docker run -p 8080:8080 -p 5000:5000 --name jenkins \
-u root \
-v /mydata/jenkins_home:/var/jenkins_home \
-d jenkins/jenkins:lts
```

`docker exec -it jenkins bin/bash`

### SSH密钥

```
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDT7znGpqBRFikCXW860iUFAvC1YEwFysohSIFBhRrlcfb6jUE0haMP72C9nmziEO0Z68NiV7uiflGI0uhwE2yNUdpysbXh7w52WHVumqkpL0UcfU/bHTgPceL2HJbRDhNvG8xYAIZDj2nV/4S1Jp33OC07Qv6fwsgfiNS6dGOfLl/LUhBjxs+cuzK+zZEGT4xV2M9tjlXVSkF1/bl+jiA2rdhlN949vFTmcdXEbupqACFfPuv0IPSypKpDa1FChJ1I3qd71S5t+0RUaSKQ0hseT3IcI01/ifx3m+ob6i5IyHkU+T3/9gPMdoR73daaTevMqOkZ0mhXKGg3MLO8+Czp root@39458d8e8f83

```

```
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA0+85xqagURYpAl1vOtIlBQLwtWBMBcrKIUiBQYUa5XH2+o1B
NIWjD+9gvZ5s4hDtGevDYle7on5RiNLocBNsjVHacrG14e8Odlh1bpqpKS9FHH1P
2x04D3Hi9hyW0Q4TbxvMWACGQ49p1f+EtSad9zgtO0L+n8LIH4jUunRjny5fy1IQ
Y8bPnLsyvs2RBk+MVdjPbY5V1UpBdf25fo4gNq3YZTfePbxU5nHVxG7qagAhXz7r
9CD0sqSqQ2tRQoSdSN6ne9UubftEVGkikNIbHk9yHCNNf4n8d5vqG+ouSMh5FPk9
//YDzHaEe93Wmk3rzKjpGdJoVyhoNzCzvPgs6QIDAQABAoIBABH3kfpZXfYB3vAo
Y6mk7yaBnU6DH27ORlyT/QFE+4bAJqQPHZwKSEytipIIwEpaDP/JkQLhVTLtapQi
7TmzK9y/N7nJfxXsYll+HlaGHhkzvLQxm3eD/qCwkwEyY0bN3q/ot2YuhTNtERfn
VaTV5UZ0KMGBaHy60qR5wS8dduSjrkm0J39XmLOce5pBkP6V/GSXDhlCF/bJDuvT
y9Pr7w6vCW5m4YvUvlw57n/1yCmPbk3PypG6FpvqzvaRjJpB3AAxs5xzl1UxG6iA
lmY7TRofI9os1xTI2GC5nCpkjYdYEFd/4RdyqLD6b5tf1L7NT1xsLy0wUdyqZkx8
0+AVixECgYEA9B8Myi3DxBkdqreCj98jx+83RrCnCWoL6ZbW/doF6jMFqWAwu3xH
Bg7szW3OQ9FLFbS6K9dbCC/qiS7YpdUOhDdVKyidvAbvcEsLQsyjmfES6P9Ajzxw
jtMNCKrLhBdj2d9+udepOPzKxizWK3kLGBrAUF7suILkc+pYmSx0Hs8CgYEA3j87
0cDV419ArYAktBs89GLJOF3LCyJlVls/ch4vPRTimmc/iRq9o5PdvfnotV8J1Q3y
ZP7iqPZny94t5JI1fK7a9SFOfrcDrf7Zl/ES47bmviHUfmrpo8GWNjjfotNS8W3d
pS3XMvXcvdtP6R6WCIK/VKh9ae6b6mYiXLAmpscCgYAp4SXFjYJXIuPnBKJeYi52
P0ChXO7a+5ldkmYBmKSJIAWpn/ncQB7DGE5hk6PeGIqkB6Qkn0ZbqjS3IhVCpcFe
x0tSIx6kQiBTiFw/MnIil6vh0uBVck3xAp3qzboqSAT2PJQ195xtTVjQFKMNRC+2
C+jQIOjFYpckl6BpbqnhGwKBgQC/pSVvNWr7O0spkcOUr5w7XOgJPA/3lPxvoBWw
0UiI0napEHlgP/fhk4N164d4xvBSkUlBP+2yJ3DQAtHuNQn8b0eOc98dM7Hvm0CF
XjOcuz50G/YB4S2BsVBXh2mJHdN7LvMfGc1lO0/TQ8e/zUkxI5XbacNj0ocOdG4T
IS7jRwKBgBYKBLYnwoTWHyC5HoISF0USN1XNspxQOnkH2hOFALZrE+MB9pS2bkmZ
+jC9ro+waoiZDcyWWbOYRg6yNhnRumWZH9/8DLfCVvwgaA+bcDqPBuHZEMn+r1Lf
Bb5G3ns7B+ECoFZZsz7xSfUHnGw4GtQrXb0YLv+5xkDdHZpL4bT6
-----END RSA PRIVATE KEY-----
```

## 构建Docker

```
sudo docker stop boyingVue || true \ && docker rm boyingVue || true \ && cd /mydata/jenkins_home/workspace/boying-web \ && docker build -t boyingVue . \ && docker run -d -p 8083:80 --name boyingVue boyingVue
```

```
#!/bin/bash 

#export BUILD_ID=dontKillMe这一句很重要，这样指定了，项目启动之后才不会被Jenkins杀掉。
export BUILD_ID=dontKillMe

#指定最后编译好的jar存放的位置
www_path=/var/codespace/test/

#Jenkins中编译好的jar位置
jar_path=/var/lib/jenkins/jobs/shaw/workspace/shaw-web/target/

#Jenkins中编译好的jar名称
jar_name=shaw.jar

#获取运行编译好的进程ID，便于我们在重新部署项目的时候先杀掉以前的进程
pid=$(cat /var/codespace/test/shaw-test-web.pid)

#进入指定的编译好的jar的位置
cd  ${jar_path}

#将编译好的jar复制到最后指定的位置
cp  ${jar_path}/${jar_name} ${www_path}

#进入最后指定存放jar的位置
cd  ${www_path}

#杀掉以前可能启动的项目进程
kill -9 ${pid}

#启动jar，指定SpringBoot的profiles为test,后台启动
java -jar -Dspring.profiles.active=test ${jar_name} &

#将进程ID存入到shaw-web.pid文件中
echo $! > /var/codespace/test/shaw-test-web.pid
```

```
docker run -p 8000:8000 --name boying \
--link mysql:db \
-v /etc/localtime:/etc/localtime \
-v /mydata/app/boying/logs:/var/logs \
-d boying/boying:0.0.1-SNAPSHOT

```



## 多环境动态切换yml配置

在实际的的开发中，对于一个工程，经常会有多种环境配置，例如开发环境、测试环境、生产环境等。在不同的环境下，配置有可能是不一样的，比如接口地址、数据库连接配置等。为了避免频繁的修改配置文件，我们想要简便地切换各种环境配置。好在SpringBoot提供了这样的功能，可以很方便地切换不同场景下的配置。
	
对开发配置和生产环境做了配置。上面的配置是公共配置，下面我们分别配置了开发和生产的配置。`spring.profiles`表示配置的名称，`spring.profiles.active`表示要激活的环境，值和要切换的`spring.profiles`名称一致。上面这个文件，默认激活的就是dev开发配置。
	
如果`spring.profiles.active`没有指定值，那么只会加载通用的配置。
	
工程打成jar包后，我们可以在运行的时候对配置进行选择，而不需要每次打包前都手动去修改`spring.profiles.active`的值。
	
例如在生产环境，我们可以使用release配置执行jar包`java -jar xxx.jar --spring.profiles.active=release`

## maven分模块笔记

+ maven父项目和子项目的pom.xml是有继承关系的，也就是说各个模块相同的部 分，我们可以配置到父项目的pom.xml文件中，这样子项目中的pom.xml只放自己个性的东西就可以了，这大大减少了工作量。另外，在编译和打包等 其他阶段，都可以统一在父项目中来进行，maven会自动操作其中的子项目，提高了效率。

+ 为了项目的正确运行，必须让所有的子项目使用依赖项的统一版本，必须确保应用的各个项目的依赖项和版本一致，才能保证测试的和发布的是相同的结果。
	在我们项目顶层的POM文件中，我们会看到dependencyManagement元素。通过它元素来管理jar包的版本，让子项目中引用一个依赖而不用显示的列出版本号。Maven会沿着父子层次向上走，直到找到一个拥有dependencyManagement元素的项目，然后它就会使用在这个dependencyManagement元素中指定的版本号。

+ **dependencies**即使在子项目中不写该依赖项，那么子项目仍然会从父项目中继承该依赖项（全部继承）。**dependencyManagement**里只是声明依赖，并不实现引入，因此子项目需要显示的声明需要用的依赖。如果不在子项目中声明依赖，是不会从父项目中继承下来的；只有在子项目中写了该依赖项，并且没有指定具体版本，才会从父项目中继承该项，并且version和scope都读取自父pom;另外如果子项目中指定了版本号，那么会使用子项目中指定的jar版本。